# UOAssistサポートファイル
Ultima Online classic client操作補助ツール"UOAssist"の利便性を向上(?)するためのファイル群です。

__目次__

- [shadow_guard_throwing.cfg](#shadow_guard_throwingcfg)
- [repair_deed_<修理スキル名>.cfg](#repair_deed_修理スキル名cfg)
- [repair_deed_CHARGE.cfg](#repair_deed_chargecfg)
- [launch_recovery.reg](#launch_recoveryreg)
- [training.sh](#trainingsh)

## shadow_guard_throwing.cfg
シャドウガード - バー・果樹園・武具屋の各ステージ向けに、アイテムを投げる動作を含むマクロです。

__マクロステップ__

0. シャンパンフルートグラス使用
0. 1100ミリ秒待機
0. リカーの瓶使用
0. 魔法のりんご使用
0. 護符使用
0. 斧使用

シャンパンフルートグラス・斧は単に「アイテム使用」なのでキャラクターが所持するアイテムで再設定する必要があります。

2.～5.は各部屋にいる時どれかが反応するので、アイテム使用後の待機時間は考慮不要です。  
バー以外では0.はWクリックしても効果のないアイテムに再設定すると無駄に酔わなくて済みます。面倒でなければ待機時間は0にしていいかもしれません。

__バーの酒瓶__

バー内の投げるために出現する瓶と、同じ絵柄で飲むことの出来る普通の「リカーの瓶」は、アイテムタイプとしては同じに見えるようです。  
どちらもバッグ内にある時は、飲める瓶のほうが使われて(飲んで)しまいます。  
バーに入る時は持たないようにするしかなさそうです。

__果樹園のりんご__

「魔法のりんご」と食べることの出来る普通の「りんご」はアイテムタイプとしては同じに見えるようです。  
どちらもバッグ内にある時は、食べることの出来るリンゴのほうが使われて(食べて)しまいます。  
ペットの餌として持ち歩く時は桃など別の果物にします。

__武具屋の護符__

浄化してもオブジェクトID/タイプともに変わらないようで、複数バッグにある時は、最初に入れたものだけが反応するようです。  
このマクロだけで武具屋をこなそうとすると、1回投げるごとに火桶を往復することになります。  
好みの問題ですが、自分の場合は以下のようにしています。

- 黒い状態のものをできるだけ拾う
- マクロで護符使用 → 火桶で浄化
- 2個目以降は自力でWクリック → ラストターゲット(火桶になってる）で持ってる分全部浄化
- マクロでまとめて投げる

## repair_deed_<修理スキル名>.cfg
修理証書をまとめて作成します。  
各マクロステップは以下手順の繰り返しで、UOAマクロは200ステップが上限のため一回の実行で50枚作成できます。  

__マクロステップ__

0. 作成道具種別使用 (裁縫道具など)
0. 「修理」メニュー選択
0. ブランクスクロール種別ターゲット
0. 1100ミリ秒待機

各スキルに対応する「道具種別使用」は以下のものを使用しています。種別使用なので、合わせればマクロのカスタマイズは不要だと思われます。
- 細工 細工道具(修理台メニューのアイコンと同じ)
- 鍛冶 鍛冶ハンマー
- 大工 ノコギリ
- 裁縫 裁縫道具
- 石工 石工道具
- ガラス細工 ガラス吹きパイプ
- 弓矢工 弓矢作成ツール

## repair_deed_CHARGE.cfg
修理台に証書をチャージします。  
マクロステップは2.以降が繰り返しで198枚チャージできますが、そんなに鞄には持てないので、なくなったら「停止」でマクロ実行を止めます。

__マクロステップ__

0. 修理台使用
0. 「チャージ追加」メニュー選択
0. 修理証書種別ターゲット

0.の「修理台使用」は設置してある対象に再設定する必要があると思われます。
修理証書種別ターゲットはスキルに関係なく反応するようなので、修理対象は混ざっていてもOK。  
作成マクロと組み合わせることで、ぎゅいーんとチャージできます :)

## launch_recovery.reg
UOAアップデーターサーバーダウン時に、起動カウントをリセットするWindowsレジストリ設定です。  

## training.sh
1回分のマクロ動作を目一杯繰り返しするマクロに変換します。  
Linux(Ubuntu)/macOSのbashで動作確認しています。  
マクロ名は日本語(UTF8)で指定できますが、生成時は(ちゃんと)CP932に変換しています。改行コードもCR/LF形式です。  
変換結果は標準出力されるため、リダイレクトでファイルへ書き込んでください。

__コマンドライン書式__  
`training.sh -f {UOAマクロファイル名} -c {マクロ名}`

__例__  
`training.sh -f UOA-Macro13.cfg -c 知性評価訓練 > UOA-Macro.cfg`
